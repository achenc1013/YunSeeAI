# CVE漏洞扫描模块 - 快速使用指南

## 🎉 新功能上线！

YunSeeAI现在可以检测网站的安全漏洞（CVE）了！

## 🚀 立即测试

### 1. 启动YunSeeAI

```powershell
npm start
```

### 2. 输入查询

试试这些命令：

```
我想知道 https://example.com 是否存在漏洞？

https://example.com 有啥漏洞？

检查 https://github.com 的安全问题
```

### 3. 查看结果

AI会自动：
1. 🔍 扫描网站技术栈
2. 🔎 查询已知CVE
3. 📊 按严重程度分类
4. 🤖 分析威胁和建议

## 💡 示例对话

```
你: 我想知道 http://pay.shunsui.icu 是否存在漏洞？

🔍 检测到扫描请求，正在执行扫描...
   目标: http://pay.shunsui.icu
   类型: vulnerability

✓ 扫描完成！

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
📊 扫描结果:

目标: http://pay.shunsui.icu
扫描模式: 本地+在线

发现漏洞: 2 个

🔴 Critical 级别 (1):

  【CVE-2021-3129】
  组件: Laravel 8.0.0
  描述: Laravel Framework RCE via crafted X-Forwarded-For header
  影响: Remote Code Execution
  CVSS: 9.8

🟠 High 级别 (1):

  【CVE-2021-23017】
  组件: Nginx 1.18.0
  描述: Nginx DNS resolver off-by-one heap write
  影响: Denial of Service, Potential RCE
  CVSS: 8.1

⚠️ 安全建议:
  • 发现 1 个严重漏洞，建议立即修复
  • 发现 1 个高危漏洞，建议尽快处理
  • 建议更新受影响的组件到安全版本
  • 可以访问 https://nvd.nist.gov/vuln/detail/[CVE-ID] 查看详情

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

🤖 YunSeeAI 分析:
该网站存在严重的远程代码执行漏洞(CVE-2021-3129)，这是Laravel框架的已知高危漏洞，攻击者可以通过构造特殊的请求头获取服务器控制权。建议立即将Laravel升级到8.4.2以上版本，同时检查Nginx配置确保DNS解析器安全。由于这些都是可被远程利用的高危漏洞，应当优先处理Laravel的严重漏洞，然后更新Nginx到1.20+版本。
```

## 📋 支持的查询方式

### 基础查询

```
xxx网站有漏洞吗？
xxx网站有啥漏洞？
xxx网站是否存在漏洞？
检查xxx网站的安全问题
扫描xxx网站的CVE
```

### 高级查询

```
xxx网站有严重漏洞吗？
xxx网站的WordPress有什么漏洞？
检查xxx网站是否有RCE漏洞
xxx网站的框架存在哪些安全问题？
```

## 🎯 关键词

AI会自动识别这些关键词：

**中文**: 漏洞、安全漏洞、安全问题、CVE
**英文**: vulnerability, cve, exploit, security issue

## 📊 漏洞级别说明

| 图标 | 级别 | 说明 | 紧急度 |
|------|------|------|--------|
| 🔴 | Critical | 严重漏洞 | 立即修复 |
| 🟠 | High | 高危漏洞 | 尽快处理 |
| 🟡 | Medium | 中危漏洞 | 计划修复 |
| 🟢 | Low | 低危漏洞 | 关注即可 |

## 🔍 扫描范围

### 已支持的技术栈

✅ **Web服务器**
- Nginx
- Apache
- IIS

✅ **CMS系统**
- WordPress
- Joomla
- Drupal

✅ **开发框架**
- Django (Python)
- Flask (Python)
- Laravel (PHP)
- Express (Node.js)
- Spring (Java)
- ASP.NET

✅ **数据库**
- MySQL
- PostgreSQL
- Redis
- MongoDB

✅ **其他**
- OpenSSH
- 更多持续添加...

## 🌐 数据来源

### 本地数据库
- 内置常见框架的已知漏洞
- 快速响应，无需网络
- 定期更新

### 在线查询（默认启用）
- CVE Search API (cve.circl.lu)
- 实时最新CVE数据
- 自动查询，无需配置

## ✅ 最佳实践

### 1. 定期扫描
```
每周或每月扫描一次你的网站
```

### 2. 新网站上线前
```
部署前先扫描，发现问题及时修复
```

### 3. 听闻新漏洞时
```
新闻报道某框架有漏洞，立即扫描检查
```

### 4. 框架更新后
```
更新框架版本后再扫描确认安全
```

## ⚠️ 注意事项

### 准确性
- ✅ 基于公开CVE数据
- ⚠️ 可能有误报（版本识别不准）
- ⚠️ 可能有漏报（新漏洞未收录）

### 建议
1. 发现漏洞后查看官方公告确认
2. 测试更新前先在测试环境验证
3. 关注CVE详情页了解更多信息
4. 配合其他工具交叉验证

### 限制
- 只能检测已公开的CVE
- 不能检测0day漏洞
- 不能检测配置错误
- 需要能识别技术栈版本

## 🔗 查看CVE详情

发现CVE后，可以访问：

```
https://nvd.nist.gov/vuln/detail/CVE-2021-41773
```

替换最后的CVE编号即可查看详细信息。

## 🆘 常见问题

### Q1: 扫描需要多久？
**A**: 通常5-15秒，取决于：
- 指纹识别速度（自动进行）
- 网络速度（如果启用在线查询）
- 检测到的技术数量

### Q2: 会扫描所有漏洞吗？
**A**: 扫描已检测到的技术栈的已知CVE。
- ✅ 能识别的框架和版本
- ❌ 未识别的技术
- ❌ 0day漏洞

### Q3: 如何提高准确性？
**A**: 
1. 确保网站可以正常访问
2. 目标网站有明显的技术特征
3. 使用在线查询（默认启用）

### Q4: 没有发现漏洞就安全吗？
**A**: 不完全是！
- ✅ 已知CVE没有发现
- ❌ 不代表没有0day
- ❌ 不代表配置安全
- 建议: 定期扫描+及时更新

### Q5: 可以离线使用吗？
**A**: 可以！
- 本地数据库可离线查询
- 但在线查询更准确全面
- 建议联网使用

## 🎓 进阶使用

### 结合其他扫描

```
# 先扫描技术栈
你: 告诉我 example.com 用的什么框架

AI: [检测到Django 3.2.0, Nginx 1.18.0]

# 再查漏洞
你: 这些框架有漏洞吗？

AI: [针对性CVE查询]
```

### 持续对话

```
你: example.com 有漏洞吗？

AI: [发现CVE-2021-3129 Laravel RCE]

你: 这个漏洞严重吗？

AI: 这是严重的远程代码执行漏洞...

你: 怎么修复？

AI: 建议升级到Laravel 8.4.2+...
```

## 📈 功能对比

| 功能 | 普通漏扫 | YunSeeAI CVE |
|------|----------|--------------|
| 自然语言 | ❌ | ✅ |
| 自动识别技术 | 部分 | ✅ |
| CVE查询 | ✅ | ✅ |
| AI威胁分析 | ❌ | ✅ |
| 修复建议 | 简单 | 详细 |
| 使用难度 | 高 | 低 |

## 🎉 总结

现在你可以：
- ✅ 用自然语言查询漏洞
- ✅ 自动识别技术栈
- ✅ 获取CVE详细信息
- ✅ 得到AI安全分析
- ✅ 获得修复建议

只需要说：**"xxx网站有漏洞吗？"**

---

**立即开始**: `npm start` 然后问 AI 你关心的网站！🛡️

更多信息查看: `scanner/CVE_MODULE_README.md`

