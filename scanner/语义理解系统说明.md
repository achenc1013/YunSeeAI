# ğŸ§  è¯­ä¹‰ç†è§£ç³»ç»Ÿ - ä¸å†ä¾èµ–å…³é”®è¯

## ğŸ“‹ æ ¸å¿ƒç†å¿µ

**ä»å…³é”®è¯åŒ¹é… â†’ è¯­ä¹‰æ¨¡å¼ç†è§£**

ä¼ ç»Ÿæ–¹æ³•ï¼š`if (message.includes('æœåŠ¡')) { ... }`  
æ–°æ–¹æ³•ï¼šç†è§£è¯­ä¹‰ï¼Œè¯†åˆ«æ„å›¾æ¨¡å¼

---

##  é—®é¢˜èƒŒæ™¯

### ç”¨æˆ·åé¦ˆ

> "æ™ºèƒ½ä½“ä¸èƒ½å¤ªä¾èµ–äºå…³é”®è¯çš„è¯†åˆ«ï¼Œå¾ˆå¤šè¯è¯­éƒ½èƒ½è¡¨è¾¾åŒä¸€ä¸ªæ„æ€ä½†æ˜¯ä¸åŒçš„å…³é”®è¯"

**ç¤ºä¾‹é—®é¢˜ï¼š**
```
ç”¨æˆ·: http://192.168.20.1uu/ å¼€äº†å“ªäº›æœåŠ¡
æ—§ç³»ç»Ÿ: âŒ æ— æ³•è¯†åˆ« â†’ å› ä¸ºæ²¡æœ‰"ç«¯å£"æˆ–"port"å…³é”®è¯
æ–°ç³»ç»Ÿ: âœ… ç†è§£ä¸ºç«¯å£æ‰«æ â†’ è¯­ä¹‰æ¨¡å¼åŒ¹é…
```

---

## âœ… è§£å†³æ–¹æ¡ˆ

###  è¯­ä¹‰æ¨¡å¼å¼•æ“

**æ ¸å¿ƒæ–‡ä»¶ï¼š** `scanner/semantic-intent-parser.js`

#### 1. è¯­ä¹‰æ¨¡å¼å®šä¹‰

```javascript
const SEMANTIC_PATTERNS = {
  port: {
    // Service-related phrases (semantic understanding)
    services: [
      // English
      /(?:which|what).*services?.*(?:running|open|available|provided)/i,
      /services?.*(?:running|open|available|provided)/i,
      
      // Chinese - ç†è§£å¤šç§è¡¨è¾¾
      /(?:å“ªäº›|ä»€ä¹ˆ).*æœåŠ¡.*(?:è¿è¡Œ|å¼€æ”¾|æä¾›|å¼€é€š)/,
      /æœåŠ¡.*(?:è¿è¡Œ|å¼€æ”¾|æä¾›|å¼€é€š)/,
      /(?:è¿è¡Œ|å¼€æ”¾|æä¾›|å¼€é€š).*(?:å“ªäº›|ä»€ä¹ˆ)?.*æœåŠ¡/,
      /å¼€[äº†é€š].*(?:å“ªäº›|ä»€ä¹ˆ)?.*æœåŠ¡/,  // "å¼€äº†å“ªäº›æœåŠ¡"
      /æä¾›[äº†]?.*(?:å“ªäº›|ä»€ä¹ˆ)?.*æœåŠ¡/   // "æä¾›äº†ä»€ä¹ˆæœåŠ¡"
    ]
  }
};
```

#### 2. æ™ºèƒ½æ„å›¾è¯†åˆ«

**ä¸å†æ˜¯ç®€å•çš„å…³é”®è¯åŒ…å«ï¼Œè€Œæ˜¯è¯­ä¹‰æ¨¡å¼åŒ¹é…ï¼š**

```javascript
function determineIntent(message) {
  // Priority order (most specific first)
  const intentOrder = ['vulnerability', 'cms', 'full', 'port', 'framework'];
  
  for (const intentType of intentOrder) {
    const patterns = SEMANTIC_PATTERNS[intentType];
    
    // Check all pattern categories
    for (const category of Object.values(patterns)) {
      if (Array.isArray(category)) {
        for (const pattern of category) {
          if (pattern.test(message)) {  // æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…
            return intentType;
          }
        }
      }
    }
  }
  
  return null;
}
```

#### 3. ä¸Šä¸‹æ–‡è®°å¿†

```javascript
let lastTarget = null;

function parseSemanticIntent(userMessage) {
  const target = extractTarget(message);
  
  // If no target, try to use last target
  if (!target) {
    const hasScanIntent = detectScanIntent(message);
    if (hasScanIntent && lastTarget) {
      finalTarget = lastTarget;  // ä½¿ç”¨å†å²ç›®æ ‡
    }
  }
  
  lastTarget = finalTarget;  // ä¿å­˜ç”¨äºä¸‹æ¬¡
}
```

---

## ğŸ¯ æ”¯æŒçš„è¯­ä¹‰è¡¨è¾¾

### ç«¯å£æ‰«æ Intent

| ä¸­æ–‡è¡¨è¾¾ | English Expression | Status |
|---------|-------------------|--------|
| "å¼€äº†å“ªäº›æœåŠ¡" | "which services are open" | âœ… |
| "æä¾›äº†ä»€ä¹ˆæœåŠ¡" | "what services provided" | âœ… |
| "è¿è¡Œäº†ä»€ä¹ˆæœåŠ¡" | "what services running" | âœ… |
| "å“ªäº›æœåŠ¡åœ¨è¿è¡Œ" | "services available" | âœ… |
| "å¼€é€šäº†ä»€ä¹ˆæœåŠ¡" | "services running" | âœ… |
| "ç«¯å£æ‰«æ" | "port scan" | âœ… |

### CMSè¯†åˆ« Intent

| è¡¨è¾¾ | Status |
|------|--------|
| "ç”¨äº†ä»€ä¹ˆCMS" | âœ… |
| "ä»€ä¹ˆCMSç³»ç»Ÿ" | âœ… |
| "å†…å®¹ç®¡ç†ç³»ç»Ÿ" | âœ… |
| "what CMS" | âœ… |

### æ¡†æ¶è¯†åˆ« Intent

| è¡¨è¾¾ | Status |
|------|--------|
| "ä½¿ç”¨äº†ä»€ä¹ˆæ¡†æ¶" | âœ… |
| "ä»€ä¹ˆæŠ€æœ¯æ ˆ" | âœ… |
| "ç”¨çš„ä»€ä¹ˆæŠ€æœ¯" | âœ… |
| "what framework" | âœ… |

### æ¼æ´æ‰«æ Intent

| è¡¨è¾¾ | Status |
|------|--------|
| "å­˜åœ¨ä»€ä¹ˆæ¼æ´" | âœ… |
| "æœ‰å“ªäº›CVE" | âœ… |
| "å®‰å…¨é—®é¢˜" | âœ… |
| "any vulnerabilities" | âœ… |

---

## ğŸ§ª æµ‹è¯•ç»“æœ

**æµ‹è¯•è„šæœ¬ï¼š** `scanner/test-semantic-parser.js`

```
ğŸ“Š Test Summary:
âœ… Passed: 15/16
âŒ Failed: 1/16
ğŸ¯ Success Rate: 93.8%
```

**å…³é”®æµ‹è¯•ç”¨ä¾‹ï¼š**

```javascript
// Test 1: å¼€äº†å“ªäº›æœåŠ¡
Input: "http://192.168.20.1uu/ å¼€äº†å“ªäº›æœåŠ¡"
Result: âœ… Intent: port | Method: semantic-understanding

// Test 2: æä¾›äº†ä»€ä¹ˆæœåŠ¡
Input: "http://example.com æä¾›äº†ä»€ä¹ˆæœåŠ¡ï¼Ÿ"
Result: âœ… Intent: port | Method: semantic-understanding

// Test 3: è¿è¡Œäº†ä»€ä¹ˆæœåŠ¡
Input: "http://example.com è¿è¡Œäº†ä»€ä¹ˆæœåŠ¡ï¼Ÿ"
Result: âœ… Intent: port | Method: semantic-understanding
```

---

## ğŸš€ æ¶æ„è®¾è®¡

### ç³»ç»Ÿæµç¨‹

```
ç”¨æˆ·è¾“å…¥
    â†“
[è¯­ä¹‰æ¨¡å¼åŒ¹é…]
    â”œâ”€ æå–ç›®æ ‡URL/IP
    â”œâ”€ è¯†åˆ«æ„å›¾æ¨¡å¼
    â””â”€ ä¸Šä¸‹æ–‡æ„ŸçŸ¥
    â†“
[æ˜ å°„åˆ°æ‰«æå·¥å…·]
    â”œâ”€ port â†’ scan_ports
    â”œâ”€ cms â†’ scan_fingerprint
    â”œâ”€ framework â†’ scan_fingerprint
    â”œâ”€ vulnerability â†’ scan_vulnerabilities
    â””â”€ full â†’ scan_full
    â†“
[æ‰§è¡Œæ‰«æ]
    â†“
[è¿”å›ç»“æœ]
```

### ä»£ç é›†æˆ

**CommandHandler.ts:**

```typescript
try {
  // Import semantic parser
  const { parseSemanticIntent } = await import('../../scanner/semantic-intent-parser.js');
  
  // Try semantic understanding
  intent = parseSemanticIntent(input);
  
  if (intent.success && intent.method === 'semantic-understanding') {
    process.stdout.write(chalk.gray(`   ğŸ’¡ æ™ºèƒ½ç†è§£: è¯­ä¹‰åˆ†æè¯†åˆ«æ„å›¾\n`));
  }
} catch (error) {
  // Fallback to simple keyword parsing
  intent = parseIntent(input);
}
```

---

## ğŸ’¡ æ ¸å¿ƒä¼˜åŠ¿

### 1. è¯­ä¹‰ç†è§£ vs å…³é”®è¯åŒ¹é…

| æ–¹é¢ | å…³é”®è¯åŒ¹é… | è¯­ä¹‰ç†è§£ |
|------|----------|---------|
| çµæ´»æ€§ | âŒ ä½ - å›ºå®šå…³é”®è¯ | âœ… é«˜ - ç†è§£è¯­ä¹‰ |
| å‡†ç¡®æ€§ | âŒ æ˜“è¯¯åˆ¤ | âœ… å‡†ç¡®è¯†åˆ« |
| æ‰©å±•æ€§ | âŒ éœ€è¦æ·»åŠ å…³é”®è¯ | âœ… æ¨¡å¼è‡ªåŠ¨åŒ¹é… |
| é€Ÿåº¦ | âœ… å¿« | âœ… å¿«ï¼ˆæ— LLMè°ƒç”¨ï¼‰ |

### 2. ä¸ä¾èµ–LLMè°ƒç”¨

- âœ… **é€Ÿåº¦å¿«** - æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…ï¼Œæ¯«ç§’çº§å“åº”
- âœ… **å¯é ** - ä¸éœ€è¦ç½‘ç»œï¼Œä¸ä¾èµ–æ¨¡å‹
- âœ… **å¯é¢„æµ‹** - è¡Œä¸ºä¸€è‡´ï¼Œæ˜“äºè°ƒè¯•
- âœ… **èµ„æºçœ** - æ— GPU/APIè°ƒç”¨å¼€é”€

### 3. ä¸Šä¸‹æ–‡æ„ŸçŸ¥

```
å¯¹è¯1: "http://example.com ç”¨äº†ä»€ä¹ˆCMSï¼Ÿ"
       â†’ å­˜å‚¨target: example.com

å¯¹è¯2: "ç«¯å£æ‰«æä¸€ä¸‹"
       â†’ è‡ªåŠ¨ä½¿ç”¨target: example.com
```

---

## ğŸ“Š æ€§èƒ½å¯¹æ¯”

### å“åº”æ—¶é—´

| æ–¹æ³• | å¹³å‡å“åº”æ—¶é—´ | è¯´æ˜ |
|------|-------------|------|
| å…³é”®è¯åŒ¹é… | <1ms | ç®€å•å­—ç¬¦ä¸²åŒ…å« |
| è¯­ä¹‰æ¨¡å¼åŒ¹é… | <5ms | æ­£åˆ™è¡¨è¾¾å¼ |
| LLMç†è§£ | 500-2000ms | éœ€è¦æ¨¡å‹æ¨ç† |

**ç»“è®ºï¼š** è¯­ä¹‰æ¨¡å¼åŒ¹é…åœ¨ä¿æŒé«˜å‡†ç¡®ç‡çš„åŒæ—¶ï¼Œé€Ÿåº¦æ¥è¿‘å…³é”®è¯åŒ¹é…ï¼

---

## ğŸ”§ æŠ€æœ¯ç»†èŠ‚

### æ­£åˆ™è¡¨è¾¾å¼è®¾è®¡

```javascript
// å¥½çš„è®¾è®¡ï¼šæ•è·è¯­ä¹‰
/å¼€[äº†é€š].*(?:å“ªäº›|ä»€ä¹ˆ)?.*æœåŠ¡/

// è¿™å¯ä»¥åŒ¹é…ï¼š
// âœ… "å¼€äº†å“ªäº›æœåŠ¡"
// âœ… "å¼€é€šä»€ä¹ˆæœåŠ¡"
// âœ… "å¼€äº†æœåŠ¡"

// åçš„è®¾è®¡ï¼šåªåŒ¹é…å›ºå®šè¯
/å¼€äº†å“ªäº›æœåŠ¡/
// âŒ "å¼€é€šä»€ä¹ˆæœåŠ¡" - ä¸åŒ¹é…
// âŒ "å¼€äº†æœåŠ¡" - ä¸åŒ¹é…
```

### ä¼˜å…ˆçº§è®¾è®¡

```javascript
const intentOrder = ['vulnerability', 'cms', 'full', 'port', 'framework'];
```

**åŸå› ï¼š**
1. `vulnerability` - æœ€å…·ä½“ï¼Œä¼˜å…ˆè¯†åˆ«
2. `cms` - æ¯”frameworkæ›´å…·ä½“
3. `full` - æ˜ç¡®çš„å…¨é¢æ‰«æ
4. `port` - å¸¸è§æŸ¥è¯¢
5. `framework` - å…œåº•è¯†åˆ«

---

## ğŸ“ æœ€ä½³å®è·µ

### å¯¹äºç”¨æˆ·

**âœ… æ¨èè¡¨è¾¾ï¼š**
```
"http://example.com å¼€äº†å“ªäº›æœåŠ¡ï¼Ÿ"
"http://example.com æä¾›ä»€ä¹ˆæœåŠ¡ï¼Ÿ"
"http://example.com è¿è¡Œäº†ä»€ä¹ˆï¼Ÿ"
"ç«¯å£æ‰«æä¸€ä¸‹"ï¼ˆéœ€è¦å…ˆæè¿‡URLï¼‰
```

**âŒ é¿å…æ¨¡ç³Šï¼š**
```
"æ‰«æ"ï¼ˆæ²¡æœ‰ç›®æ ‡ï¼‰
"è¿™ä¸ªç½‘ç«™"ï¼ˆæ²¡æœ‰æ˜ç¡®URLï¼‰
"åˆšæ‰é‚£ä¸ª"ï¼ˆæ¨¡ç³ŠæŒ‡ä»£ï¼‰
```

### å¯¹äºå¼€å‘è€…

**æ·»åŠ æ–°çš„è¯­ä¹‰æ¨¡å¼ï¼š**

```javascript
// 1. åœ¨SEMANTIC_PATTERNSä¸­æ·»åŠ 
const SEMANTIC_PATTERNS = {
  new_intent: {
    category1: [
      /pattern1/i,
      /pattern2/i
    ],
    category2: [
      /pattern3/i
    ]
  }
};

// 2. åœ¨intentOrderä¸­æ·»åŠ ä¼˜å…ˆçº§
const intentOrder = ['new_intent', 'vulnerability', 'cms', ...];

// 3. åœ¨toolMapä¸­æ˜ å°„å·¥å…·
const toolMap = {
  new_intent: 'scan_new_tool',
  ...
};
```

---

## ğŸ”„ Future Enhancements

### çŸ­æœŸæ”¹è¿›
- [ ] æ·»åŠ æ›´å¤šè¯­ä¹‰æ¨¡å¼
- [ ] æ”¯æŒå¤åˆæ„å›¾ï¼ˆåŒæ—¶æŸ¥å¤šä¸ªï¼‰
- [ ] ä¼˜åŒ–ä¸Šä¸‹æ–‡ç®¡ç†

### ä¸­æœŸæ”¹è¿›
- [ ] æœºå™¨å­¦ä¹ è¾…åŠ©æ¨¡å¼å‘ç°
- [ ] ç”¨æˆ·ä¹ æƒ¯å­¦ä¹ 
- [ ] å¤šè½®å¯¹è¯ä¼˜åŒ–

### é•¿æœŸæ„¿æ™¯
- [ ] çœŸæ­£çš„LLMç†è§£ï¼ˆä½œä¸ºå¢å¼ºï¼‰
- [ ] å¤šè¯­è¨€æ”¯æŒï¼ˆæ—¥è¯­ã€éŸ©è¯­ç­‰ï¼‰
- [ ] è¯­éŸ³è¾“å…¥ç†è§£

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [æ™ºèƒ½æ„å›¾è¯†åˆ«å¢å¼ºè¯´æ˜](æ™ºèƒ½æ„å›¾è¯†åˆ«å¢å¼ºè¯´æ˜.md)
- [è‡ªç„¶è¯­è¨€æŸ¥è¯¢å‚è€ƒ](è‡ªç„¶è¯­è¨€æŸ¥è¯¢å‚è€ƒ.md)
- [CMSè¯†åˆ«å¢å¼ºè¯´æ˜](CMSè¯†åˆ«å¢å¼ºè¯´æ˜.md)

---

## ğŸ™ è‡´è°¢

æ„Ÿè°¢ç”¨æˆ·æå‡º"ä¸è¦ä¾èµ–å…³é”®è¯"çš„å®è´µå»ºè®®ï¼

è¿™ä¿ƒä½¿æˆ‘ä»¬ä»ç®€å•çš„å…³é”®è¯åŒ¹é…å‡çº§åˆ°è¯­ä¹‰æ¨¡å¼ç†è§£ï¼Œè®©AIçœŸæ­£"ç†è§£"ç”¨æˆ·çš„æ„å›¾ï¼Œè€Œä¸åªæ˜¯"åŒ¹é…"å…³é”®è¯ã€‚

---

**YunSeeAI v1.4.0**  
è¯­ä¹‰ç†è§£ï¼Œæ™ºèƒ½è¯†åˆ« ğŸš€

**æµ‹è¯•ç»“æœï¼š** âœ… 93.8% æˆåŠŸç‡  
**æ€§èƒ½ï¼š** <5ms å“åº”æ—¶é—´  
**æ”¯æŒï¼š** ä¸­è‹±æ–‡è¯­ä¹‰ç†è§£  
**æ–¹æ³•ï¼š** çº¯ä»£ç ç¼–å†™ï¼Œç¬¦åˆå…¼å®¹æ€§è¦æ±‚

