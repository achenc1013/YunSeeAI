# 🧠 YunSeeAI 知识库功能使用说明

## 📋 功能概述

YunSeeAI 现已集成 **AI自主学习知识库** 功能，允许您向系统投喂自定义知识，AI会自动学习并在回答问题时优先使用这些知识。

### ✨ 核心特性

- 🧠 **AI自主学习** - AI自动从知识库中检索相关内容
- 🔍 **智能语义搜索** - 基于关键词匹配的智能搜索
- 📁 **文件支持** - 支持从txt、md等文件添加知识
- 🎯 **优先级系统** - 网络搜索 > 知识库 > 普通对话
- 💾 **持久化存储** - 知识自动保存到本地

---

## 🚀 快速开始

### 1. 启动系统

```bash
npm start
```

### 2. 添加知识

#### 方法一：直接添加文本知识

```
/kb add Python是一种高级编程语言，广泛应用于数据分析、Web开发和人工智能领域
```

#### 方法二：从文件添加知识

```
/kb addfile ./docs/security-guide.md
```

### 3. 查看知识库

```
/kb list
```

### 4. 搜索知识

```
/kb search Python
```

### 5. 向AI提问（自动使用知识库）

当您向AI提问时，系统会自动搜索知识库中的相关内容：

```
You: Python有什么特点？

🤖 YunSeeAI: 【从知识库检索到相关内容】
Python是一种高级编程语言，具有以下特点...
```

---

## 📚 命令详解

### 基本命令

| 命令 | 说明 | 示例 |
|------|------|------|
| `/kb add <内容>` | 添加知识到知识库 | `/kb add Docker是一个容器化平台` |
| `/kb addfile <文件>` | 从文件添加知识 | `/kb addfile ./docs/readme.md` |
| `/kb list` | 列出所有知识 | `/kb list` |
| `/kb search <查询>` | 搜索知识库 | `/kb search Docker` |
| `/kb delete <ID>` | 删除指定知识 | `/kb delete kb_1234567890_abc123` |
| `/kb stats` | 显示知识库统计 | `/kb stats` |
| `/kb clear` | 清空知识库 | `/kb clear` |
| `/kb help` | 显示帮助 | `/kb help` |

---

## 💡 使用场景

### 场景1：安全漏洞知识库

```bash
# 添加CVE知识
/kb add CVE-2024-1234是一个影响Apache Struts的远程代码执行漏洞

# 添加修复建议
/kb add Apache Struts CVE-2024-1234修复方案：升级到2.5.32或更高版本

# 查询时AI会自动引用
You: Apache Struts有什么漏洞？
```

### 场景2：技术文档知识库

```bash
# 从文档添加知识
/kb addfile ./docs/kubernetes-guide.md
/kb addfile ./docs/docker-best-practices.md

# 查询时自动引用文档内容
You: Kubernetes如何部署应用？
```

### 场景3：内部规范知识库

```bash
# 添加公司安全规范
/kb add 公司SSH端口必须修改为非标准端口，禁止使用root直接登录

# 添加审计规则
/kb add 所有生产服务器必须启用日志审计，保留至少90天

# 审计时AI会参考规范
You: 检查系统安全
```

---

## 🎯 优先级说明

当您向AI提问时，系统会按照以下优先级获取信息：

```
1️⃣ 网络搜索（如果启用）
    ↓
2️⃣ 本地知识库
    ↓
3️⃣ AI自身知识
```

### 示例流程

```
用户问题: "什么是Docker?"
    ↓
[检查网络搜索] - 未启用，跳过
    ↓
[检查知识库] - 找到3条相关知识
    ↓
[AI生成回答] - 基于知识库内容 + AI理解
```

---

## 📊 知识库管理

### 查看统计信息

```
/kb stats
```

输出示例：
```
📊 知识库统计:

  总条目数: 15
  总大小: 23.45 KB

  按来源分类:
    manual: 8 条
    file: 7 条
```

### 列出所有知识

```
/kb list
```

输出示例：
```
📚 知识库列表 (共 15 条):

kb_1699234567_a1b2c3
  来源: manual
  时间: 2024-11-05 10:30:15
  内容: Python是一种高级编程语言...

kb_1699234580_d4e5f6
  来源: file (security-guide.md)
  时间: 2024-11-05 10:35:20
  内容: 安全审计是系统安全的重要组成部分...
```

### 搜索知识

```
/kb search Python编程
```

输出示例：
```
🔍 搜索结果 (共 3 条):

1. kb_1699234567_a1b2c3 (相关度: 85%)
   来源: manual
   Python是一种高级编程语言，广泛应用于数据分析、Web开发...
   匹配关键词: python, 编程

2. kb_1699234590_g7h8i9 (相关度: 70%)
   来源: file (python-guide.md)
   Python编程最佳实践：使用虚拟环境管理依赖...
   匹配关键词: python, 编程
```

---

## 🔧 高级功能

### 1. 支持的文件格式

目前支持纯文本文件：
- `.txt` - 纯文本文件
- `.md` - Markdown文档
- `.log` - 日志文件
- 其他纯文本格式

### 2. 知识检索机制

系统使用**关键词匹配**算法：
- 自动分词提取关键词
- 计算相关度评分（0-100%）
- 返回最相关的TOP 3结果
- 自动注入到AI上下文中

### 3. 自动学习流程

```
用户提问
    ↓
知识库搜索（自动）
    ↓
构建增强上下文
    ↓
AI生成回答（基于知识库）
    ↓
返回结果
```

---

## 📝 最佳实践

### ✅ 推荐做法

1. **结构化知识**
   ```
   /kb add CVE-2024-1234: Apache Struts远程代码执行漏洞，影响版本2.0-2.5.31
   ```

2. **添加标签**
   - 使用关键词帮助检索
   - 例如：`CVE` `Apache` `漏洞` `修复`

3. **定期整理**
   ```
   /kb stats  # 查看统计
   /kb list   # 检查重复
   /kb delete <ID>  # 删除过时知识
   ```

4. **从文档导入**
   ```
   /kb addfile ./knowledge/security-best-practices.md
   /kb addfile ./knowledge/vulnerability-database.txt
   ```

### ❌ 避免做法

1. **避免添加过于简短的知识**
   ```
   ❌ /kb add Python好
   ✅ /kb add Python是一种高级编程语言，具有简洁的语法和丰富的库支持
   ```

2. **避免重复添加相同知识**
   - 使用 `/kb search` 先检查是否存在

3. **避免添加过大的文件**
   - 单个知识条目建议不超过1MB
   - 大文件建议分段添加

---

## 🌐 网络搜索（预留功能）

系统已预留网络搜索接口，未来版本将支持：
- Google搜索
- Bing搜索
- DuckDuckGo搜索

配置位置：`src/config/default.ts`

```typescript
webSearch: {
  enabled: false,  // 设置为true启用
  engine: 'duckduckgo',
  maxResults: 5,
}
```

---

## 🔍 故障排除

### 问题1：知识库为空

```bash
/kb list
# 输出：知识库为空

解决：使用 /kb add 或 /kb addfile 添加知识
```

### 问题2：搜索无结果

```bash
/kb search Docker
# 输出：未找到与 "Docker" 相关的知识

原因：知识库中没有相关内容
解决：添加相关知识
```

### 问题3：无法读取文件

```bash
/kb addfile ./docs/guide.md
# 输出：✗ 无法读取文件

检查：
1. 文件路径是否正确
2. 文件是否存在
3. 文件是否为纯文本格式
```

---

## 📊 系统状态查看

使用 `/status` 命令查看完整系统状态：

```
/status
```

输出示例：
```
╔══════════════════════════════════════════════════════════════╗
║                    System Status                             ║
╚══════════════════════════════════════════════════════════════╝

AI Model:
  Status:             ✓ Active
  Context Usage:      15.3% (627/4096 tokens)
  
Knowledge Base:
  Status:             ✓ Active
  Entries:            15 条
  Total Size:         23.45 KB
  
Modules:
  🛡️  AI Assistant    ✓ Running
  📚 Knowledge Base   ✓ Running
  🔒 WAF Module       ○ Standby
  🔍 Scanner Module   ○ Standby
  ⚙️  Audit Module    ○ Standby
```

---

## 📖 示例工作流

### 完整示例：构建安全知识库

```bash
# 1. 启动系统
npm start

# 2. 添加安全相关知识
/kb add SQL注入是一种常见的Web安全漏洞，攻击者通过注入恶意SQL代码来获取或修改数据库数据
/kb add XSS跨站脚本攻击允许攻击者在用户浏览器中执行恶意脚本
/kb add CSRF跨站请求伪造利用用户的登录状态执行非授权操作

# 3. 从文件批量导入
/kb addfile ./docs/owasp-top10.md
/kb addfile ./docs/security-checklist.md

# 4. 查看知识库
/kb stats
/kb list

# 5. 测试AI理解
You: 什么是SQL注入？如何防御？

🤖 YunSeeAI: 【从知识库检索到相关内容】
SQL注入是一种常见的Web安全漏洞...
[AI基于知识库内容提供详细回答和防御建议]

# 6. 搜索特定知识
/kb search XSS

# 7. 管理知识库
/kb delete kb_1234567890_abc123  # 删除过时知识
/kb stats  # 查看最新统计
```

---

## 🎉 总结

知识库功能让YunSeeAI更加智能和个性化：

✅ **自动学习** - AI自动从知识库学习
✅ **智能检索** - 基于问题自动搜索相关知识
✅ **持久化存储** - 知识永久保存
✅ **简单易用** - 一行命令即可添加知识
✅ **灵活管理** - 完善的增删查改功能

---

## 📞 获取帮助

- 系统帮助：`/help`
- 知识库帮助：`/kb help`
- 系统状态：`/status`

---

**YunSeeAI v2.0** - 集成AI自主学习知识库 🎓

*享受更智能的AI助手体验！* 🚀


